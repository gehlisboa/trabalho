<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Buscar Postagem</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jersey+10&family=Jersey+15&display=swap" rel="stylesheet">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Seu CSS -->
    <link href="../../front_end/style.css" rel="stylesheet">

    <!-- favicon -->
    <link rel="icon" type="image/x-icon" href="../imgs/favicons/favicon-16x16.png">
  </head>
  <body>

    <!-- ===================== PARTICULAS DE FUNDO ===================== -->
    <div class="particles-bg">

        <!-- QUADRADOS CYAN -->
        <div class="particle square-cyan" style="top: 10%; left: 10%;"></div>
        <div class="particle square-cyan" style="top: 15%; left: 35%;"></div>
        <div class="particle square-cyan" style="top: 30%; left: 20%;"></div>
        <div class="particle square-cyan" style="top: 45%; left: 5%;"></div>
        <div class="particle square-cyan" style="top: 55%; left: 40%;"></div>
        <div class="particle square-cyan" style="top: 75%; left: 25%;"></div>
        <div class="particle square-cyan" style="top: 85%; left: 10%;"></div>
        <div class="particle square-cyan" style="top: 20%; left: 70%;"></div>
        <div class="particle square-cyan" style="top: 60%; left: 85%;"></div>

        <!-- QUADRADOS PINK -->
        <div class="particle square-pink" style="top: 12%; left: 60%;"></div>
        <div class="particle square-pink" style="top: 28%; left: 80%;"></div>
        <div class="particle square-pink" style="top: 35%; left: 50%;"></div>
        <div class="particle square-pink" style="top: 48%; left: 70%;"></div>
        <div class="particle square-pink" style="top: 65%; left: 55%;"></div>
        <div class="particle square-pink" style="top: 72%; left: 30%;"></div>
        <div class="particle square-pink" style="top: 82%; left: 75%;"></div>
    </div>

      <!-- NAVBAR  -->
    <nav class="navbar navbar-expand-lg custom-navbar">
      <div class="container-fluid">
        <a class="navbar-brand" href="../postagem/principal.html">Pixelift</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="../postagem/principal.html">Inicial</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../front_end/postagem/listar_postagem.html">Posts</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../front_end/postagem/noticias.html">Notícias</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../front_end/usuario/cadastrar_usuario.html">Cadastrar</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- ===================== CONTEÚDO ===================== -->

    <div class="container mt-5">
        <h3 class="mb-4">Buscar Postagem</h3>

        <div class="card p-4 shadow-sm mb-3">
            <div class="mb-3">
                <label class="form-label">ID da Postagem</label>
                <input type="number" id="codPostagem" class="form-control" placeholder="Digite o ID da postagem">
            </div>

            <button class="btn-postar" onclick="getPostagens()">
                Buscar
            </button>
        </div>

        <div id="postagemContainer"></div>
    </div>


    <!-- ===================== SCRIPT ===================== -->
    <script>
        let isLoading = false;

        function getPostagens(){
            const cod = document.getElementById('codPostagem').value || '1';
            let postagem = { CodPostagem: cod };

            isLoading = true;
            const container = document.getElementById('postagemContainer');
            container.innerHTML = `<p class="text-primary">Carregando...</p>`;

            fetch('http://localhost/trabalho/Geovanna_Victoria/back_end/postagem/buscar_postagem_por_id.php',
                {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(postagem)
                }
            )
            .then(response => response.json())
            .then(response => {
                container.innerHTML = '';

                if(response.postagens && Array.isArray(response.postagens)){
                    response.postagens.forEach(p => {
                        const div = document.createElement('div');
                        div.classList.add('card', 'mb-3');
                        div.innerHTML = `
                            <div class="card-body">
                                <h5 class="card-title">${p.Titulo}</h5>
                                <p class="card-text">${p.Conteudo}</p>
                                <p class="card-text"><small class="text-muted">Autor: ${p.Autor} | Criado em: ${p.DataCriacao}</small></p>
                                ${p.Imagem ? `<img src="${p.Imagem}" class="img-fluid mt-2"/>` : ''}
                            </div>
                        `;
                        container.appendChild(div);
                    });
                } else {
                    container.innerHTML = '<p class="text-danger">Nenhuma postagem encontrada!</p>';
                }
            })
            .catch(erro => {
                container.innerHTML = '<p class="text-danger">Erro na requisição.</p>';
            })
            .finally(()=>{
                isLoading = false;
            });
        }
    </script>

<footer class="basic-footer">
  <p>&copy; 2025 Pixelift. Todos os direitos reservados.</p>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

  </body>
</html>
